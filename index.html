<!DOCTYPE html>
<html>

<head>
    <title>Trialbench - Research Project</title>
    <!-- 引入Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #ffffff;
            --secondary-color: #ffffff;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            line-height: 1.6;
            padding-top: 60px;
        }

        table {
            margin: 0 auto;
            border-collapse: collapse;
        }

        .hero-section {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: rgb(11, 11, 11);
            padding: 4rem 0;
            margin-bottom: 3rem;
            font-size: 20px;
            font-family: "Helvetica Neue", Arial, sans-serif;
            font-weight: bold;
        }

        .main-image {
            width: 100%;
            max-width: 1600px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(245, 243, 243, 0.1);
        }

        .results-table {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .chart-container {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
    </style>
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#">Trialbench</a>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section text-center">
        <div class="container">
            <h1 class="display-4 mb-4">TrialBench: Multi-Modal
                Artificial-Intelligence-Ready Clinical Trial Datasets</h1>
            <img src="docs/main.png" alt="Methodology Overview" class="main-image">
        </div>
    </section>

    <!-- Abstract Section -->
    <section class="abstract-section py-5">
        <div class="container">
            <h2 class="text-center mb-4">Abstract</h2>
            <p class="lead text-center">
                Clinical trials are pivotal for developing new medical treatments but typically carry risks such as
                patient mortality and enrollment failure that waste immense efforts spanning over a decade. Applying
                artificial intelligence (AI) to predict key events in clinical trials holds great potential for
                providing insights to guide trial designs. However, complex data collection and question definition
                requiring medical expertise have hindered the involvement of AI thus far. This paper tackles these
                challenges by presenting a comprehensive suite of 23 meticulously curated AI-ready datasets covering
                multi-modal input features and 8 crucial prediction challenges in clinical trial design, encompassing
                prediction of trial duration, patient dropout rate, serious adverse event, mortality rate, trial
                approval outcome, trial failure reason, drug dose finding, design of eligibility criteria. Furthermore,
                we provide basic validation methods for each task to ensure the datasets' usability and reliability. We
                anticipate that the availability of such open-access datasets will catalyze the development of advanced
                AI approaches for clinical trial design, ultimately advancing clinical trial research and accelerating
                medical solution development.
            </p>
        </div>
    </section>

    <!-- Download All Section -->
    <div class="container text-center mb-5">
        <a href="dataset.zip" class="btn btn-primary btn-sm download-btn" data-key="all" id="downloadLink">
            Download All (ZIP)
        </a>
        <p class="mt-3">Downloads: <span id="all_count">(0)</span></p>
    </div>

    <!-- Download Sub-tasks Section -->
    <section class="download-subtasks py-5">
        <div class="container">
            <h2 class="text-center mb-4">Download Sub-tasks</h2>
            <ul class="list-group">
                <!-- 1. Trial Duration Forecasting -->
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Trial Duration Forecasting
                    <div>
                        <a href="trial_duration.zip" class="btn btn-primary btn-sm download-btn"
                            data-key="trial_duration">
                            Download
                        </a>
                        <small class="text-muted ms-2" id="trial_duration_count">(0)</small>
                    </div>
                </li>

                <!-- 2. Patient Dropout Event Forecasting -->
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Patient Dropout Event Forecasting
                    <div>
                        <a href="patient_dropout.zip" class="btn btn-primary btn-sm download-btn"
                            data-key="patient_dropout">
                            Download
                        </a>
                        <small class="text-muted ms-2" id="patient_dropout_count">(0)</small>
                    </div>
                </li>

                <!-- 3. Serious Adverse Event Forecasting -->
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Serious Adverse Event Forecasting
                    <div>
                        <a href="serious_adverse.zip" class="btn btn-primary btn-sm download-btn"
                            data-key="serious_adverse">
                            Download
                        </a>
                        <small class="text-muted ms-2" id="serious_adverse_count">(0)</small>
                    </div>
                </li>

                <!-- 4. Mortality Event Prediction -->
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Mortality Event Prediction
                    <div>
                        <a href="mortality_prediction.zip" class="btn btn-primary btn-sm download-btn"
                            data-key="mortality_prediction">
                            Download
                        </a>
                        <small class="text-muted ms-2" id="mortality_prediction_count">(0)</small>
                    </div>
                </li>

                <!-- 5. Trial Approval Forecasting -->
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Trial Approval Forecasting
                    <div>
                        <a href="trial_approval.zip" class="btn btn-primary btn-sm download-btn"
                            data-key="trial_approval">
                            Download
                        </a>
                        <small class="text-muted ms-2" id="trial_approval_count">(0)</small>
                    </div>
                </li>

                <!-- 6. Trial Failure Reason Identification -->
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Trial Failure Reason Identification
                    <div>
                        <a href="trial_failure.zip" class="btn btn-primary btn-sm download-btn"
                            data-key="trial_failure">
                            Download
                        </a>
                        <small class="text-muted ms-2" id="trial_failure_count">(0)</small>
                    </div>
                </li>

                <!-- 7. Eligibility Criteria Design -->
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Eligibility Criteria Design
                    <div>
                        <a href="eligibility_criteria.zip" class="btn btn-primary btn-sm download-btn"
                            data-key="eligibility_criteria">
                            Download
                        </a>
                        <small class="text-muted ms-2" id="eligibility_criteria_count">(0)</small>
                    </div>
                </li>

                <!-- 8. Drug Dose Finding -->
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Drug Dose Finding
                    <div>
                        <a href="drug_dose_finding.zip" class="btn btn-primary btn-sm download-btn"
                            data-key="drug_dose_finding">
                            Download
                        </a>
                        <small class="text-muted ms-2" id="drug_dose_finding_count">(0)</small>
                    </div>
                </li>
            </ul>
        </div>
    </section>


    <script>
        // 替换为你的 Apps Script URL
        const API_URL = "https://script.google.com/macros/s/AKfycbxNXoXFDtb9qY6jqmz2WTOk0MDscs8FkegZYNW7hFKUD32Ppe8PvMk9KwXu1TPu3LuP/exec";
        // 查找页面上所有带 .download-btn 类的链接
        document.querySelectorAll('.download-btn').forEach(btn => {
            const key = btn.getAttribute('data-key');              // 计数器的 key
            const countSpan = document.getElementById(key + '_count');

            // 1. 页面加载时，先获取当前计数 (action=get)，不增加计数
            fetch(`${API_URL}?key=${key}&action=get`)
                .then(res => res.json())
                .then(data => {
                    countSpan.textContent = `(${data.value})`;
                })
                .catch(err => console.error(err));

            // 2. 点击时，先发起 "hit" 请求增加计数，再执行实际下载
            btn.addEventListener('click', e => {
                e.preventDefault(); // 阻止默认点击行为，先处理计数逻辑

                // 发起 hit 请求，使计数 +1
                fetch(`${API_URL}?key=${key}&action=hit`)
                    .then(res => res.json())
                    .then(data => {
                        // 更新页面上的计数
                        countSpan.textContent = `(${data.value})`;

                        // 触发真正的下载
                        const tempLink = document.createElement('a');
                        tempLink.href = btn.href;
                        // 提取文件名（如果想强制下载可加 download="xxx"）
                        tempLink.download = btn.href.split('/').pop();
                        tempLink.click();
                    })
                    .catch(err => console.error(err));
            });
        });
    </script>

</body>

</html>