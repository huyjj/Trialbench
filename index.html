<!DOCTYPE html>
<html>

<head>
    <title>Trialbench - Research Project</title>
    <!-- 引入Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"
        integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        :root {
            --primary-color: #ffffff;
            --secondary-color: #ffffff;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            line-height: 1.6;
            padding-top: 60px;
        }

        table {
            margin: 0 auto;
            border-collapse: collapse;
        }

        .hero-section {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: rgb(11, 11, 11);
            padding: 4rem 0;
            margin-bottom: 3rem;
            font-size: 20px;
            font-family: "Helvetica Neue", Arial, sans-serif;
            font-weight: bold;
        }

        .main-image {
            width: 100%;
            max-width: 1600px;
            border-radius: 16px;
            box-shadow: 0 4px 6px rgba(245, 243, 243, 0.1);
            margin-bottom: 2rem;
        }

        .results-table {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .chart-container {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        #worldMap {
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .author-info {
            font-size: 1.2rem;
        }

        .author-info p {
            margin-bottom: 0.1rem;
        }

        .author-info small {
            font-size: 0.6rem;
        }
    </style>
</head>

<body>
    <!-- Hero Section -->
    <section class="hero-section text-center">
        <div class="container">
            <!-- 主图 -->
            <img src="docs/main.png" alt="Methodology Overview" class="main-image">

            <!-- 标题 -->
            <h1 class="display-4 mb-4">
                TrialBench: Benchmarking Multi-Modal Artificial-Intelligence-Ready Clinical Trial Prediction
            </h1>

            <!-- 作者信息模块 -->
            <div class="author-info mb-4">
                <p class="mb-0">
                    Jintai Chen<sup>1,†</sup>,
                    Yaojun Hu<sup>2,†</sup>,
                    Yingzhou Lu<sup>3</sup>,
                    Yue Wang<sup>2</sup>,
                    Xu Cao<sup>1</sup>,
                    Miao Lin<sup>4</sup>,
                    Hongxia Xu<sup>5</sup>,
                    Jian Wu<sup>6</sup>,
                    Cao Xiao<sup>7</sup>,
                    Jimeng Sun<sup>1</sup>,
                    Lucas Glass<sup>8</sup>,
                    Kexin Huang<sup>9</sup>,
                    Marinka Zitnik<sup>10</sup>,
                    Tianfan Fu<sup>11,*</sup>
                </p>
                <p class="text-muted mb-0"><small>1. Computer Science Department, University of Illinois at
                        Urbana-Champaign, Urbana, USA</small></p>
                <p class="text-muted mb-0"><small>2. College of Computer Science and Technology, Zhejiang University,
                        Hangzhou, China</small></p>
                <p class="text-muted mb-0"><small>3. School of Medicine, Stanford University, Stanford, CA, USA</small>
                </p>
                <p class="text-muted mb-0"><small>4. Medical Big Data Center, Guangdong Provincial People's Hospital
                        (Guangdong Academy of Medical Sciences), Southern Medical University, Guangzhou, China</small>
                </p>
                <p class="text-muted mb-0"><small>5. Innovation Institute for Artificial Intelligence in Medicine of
                        Zhejiang University, College of Pharmaceutical Sciences, Zhejiang University, Hangzhou,
                        China</small></p>
                <p class="text-muted mb-0"><small>6. The Second Affiliated Hospital, Zhejiang University School of
                        Medicine, Hangzhou, China</small></p>
                <p class="text-muted mb-0"><small>7. GE HealthCare, Chicago, USA</small></p>
                <p class="text-muted mb-0"><small>8. IQVIA, Boston, USA</small></p>
                <p class="text-muted mb-0"><small>9. Computer Science Department, Stanford University, Stanford, CA,
                        USA</small></p>
                <p class="text-muted mb-0"><small>10. Informatics, Harvard Medical School, Harvard University,
                        USA</small></p>
                <p class="text-muted mb-0"><small>11. Department of Computer Science, Rensselaer Polytechnic Institute,
                        NY, USA</small></p>
                <p class="text-muted mb-0"><small>* Corresponding author(s): Tianfan Fu (<a
                            href="mailto:futianfan@gmail.com">futianfan@gmail.com</a>)</small></p>
                <p class="text-muted"><small>† These authors contributed equally to this work.</small></p>
            </div>
        </div>
    </section>


    <!-- Abstract Section -->
    <section class="abstract-section py-5">
        <div class="container">
            <h2 class="text-center mb-4">Abstract</h2>
            <p class="lead text-left">
                Clinical trials are pivotal for developing new medical treatments but typically carry risks such as
                patient mortality and enrollment failure that waste immense efforts spanning over a decade. Applying
                artificial intelligence (AI) to predict key events in clinical trials holds great potential for
                providing insights to guide trial designs. However, complex data collection and question definition
                requiring medical expertise have hindered the involvement of AI thus far. This paper tackles these
                challenges by presenting a comprehensive suite of 23 meticulously curated AI-ready datasets covering
                multi-modal input features and 8 crucial prediction challenges in clinical trial design, encompassing
                prediction of trial duration, patient dropout rate, serious adverse event, mortality rate, trial
                approval outcome, trial failure reason, drug dose finding, design of eligibility criteria. Furthermore,
                we provide basic validation methods for each task to ensure the datasets' usability and reliability. We
                anticipate that the availability of such open-access datasets will catalyze the development of advanced
                AI approaches for clinical trial design, ultimately advancing clinical trial research and accelerating
                medical solution development.
            </p>
        </div>
    </section>

    <div class="container text-center py-5">
        <!-- 按钮组 -->
        <div class="d-flex justify-content-center gap-3">
            <!-- arXiv -->
            <a href="https://arxiv.org/pdf/2407.00631" class="btn btn-dark btn-lg" target="_blank">
                <i class="fas fa-file-pdf me-2"></i>Paper
            </a>

            <!-- Code -->
            <a href="https://github.com/ML2Health/ML2ClinicalTrials/tree/main/AI4Trial" class="btn btn-dark btn-lg"
                target="_blank">
                <i class="fab fa-github me-2"></i>Code
            </a>

            <!-- Data -->
            <a href="https://zenodo.org/records/15455785/files/all_task.zip?download=1"
                class="btn btn-dark btn-lg download-btn" data-key="all" id="downloadLink">
                <i class="fas fa-database me-2"></i>Data
            </a>
        </div>
        <small class="text-center mb-4" id="all_count" style="font-size: 0.8em; color: #6c757d;">
            Until 2025-3-4, data has been downloaded 0 times.
        </small>
    </div>

    <!-- Bootstrap JS (可选) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

</body>

<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <!-- Download Sub-tasks Section -->
    <section class="download-subtasks py-5">
        <div class="container">
            <h2 class="text-center mb-4">Download SubTask Datasets</h2>
            <ul class="list-group">
                <!-- 1. Trial Duration Forecasting -->
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Trial Duration Forecasting
                    <div>
                        <!-- 数据下载按钮 -->
                        <a href="https://zenodo.org/records/15455785/files/trial-duration-forecasting.zip?download=1"
                            class="btn btn-dark btn-lg download-btn" data-key="trial_duration">
                            Download
                        </a>
                        <button class="btn btn-dark btn-lg" type="button" data-bs-toggle="collapse"
                            data-bs-target="#pdf_trial_duration" aria-expanded="false"
                            aria-controls="pdf_trial_duration">
                            Feature Set
                        </button>
                    </div>
                    <small class="text-muted ms-2" id="trial_duration_count" style="display: none;">(0)</small>
                    <div class="collapse mt-2 max-auto" id="pdf_trial_duration" style="max-width: 800px;">
                        <div class="card card-body">
                            <div class="d-flex justify-content-center gap-2 mt-2">
                                <button class="btn btn-secondary btn-sm zoom-in" data-pdf="trial_duration">Zoom
                                    In</button>
                                <button class="btn btn-secondary btn-sm zoom-out" data-pdf="trial_duration">Zoom
                                    Out</button>
                            </div>
                            <canvas id="pdf_canvas_trial_duration"
                                style="border: 1px solid #ccc; width: 100%;"></canvas>
                        </div>
                    </div>
                </li>
                <!-- 2. Patient Dropout Event Forecasting -->
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Patient Dropout Event Forecasting
                    <div>
                        <a href="https://zenodo.org/records/15455785/files/patient-dropout-event-forecasting.zip?download=1"
                            class="btn btn-dark btn-lg download-btn" data-key="patient_dropout">
                            Download
                        </a>
                        <button class="btn btn-dark btn-lg" type="button" data-bs-toggle="collapse"
                            data-bs-target="#pdf_patient_dropout" aria-expanded="false"
                            aria-controls="pdf_patient_dropout">
                            Feature Set
                        </button>
                    </div>
                    <small class="text-muted ms-2" id="patient_dropout_count" style="display: none;">(0)</small>
                    <div class="collapse mt-2 max-auto" id="pdf_patient_dropout" style="max-width: 800px;">
                        <div class="card card-body">
                            <div class="d-flex justify-content-center gap-2 mt-2">
                                <button class="btn btn-secondary btn-sm zoom-in" data-pdf="patient_dropout">Zoom
                                    In</button>
                                <button class="btn btn-secondary btn-sm zoom-out" data-pdf="patient_dropout">Zoom
                                    Out</button>
                            </div>
                            <canvas id="pdf_canvas_patient_dropout"
                                style="border: 1px solid #ccc; width: 100%;"></canvas>

                        </div>
                    </div>
                </li>
                <!-- 3. Serious Adverse Event Forecasting -->
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Serious Adverse Event Forecasting
                    <div>
                        <a href="https://zenodo.org/records/15455785/files/serious-adverse-event-forecasting.zip?download=1"
                            class="btn btn-dark btn-lg download-btn" data-key="serious_adverse">
                            Download
                        </a>
                        <button class="btn btn-dark btn-lg" type="button" data-bs-toggle="collapse"
                            data-bs-target="#pdf_serious_adverse" aria-expanded="false"
                            aria-controls="pdf_serious_adverse">
                            Feature Set
                        </button>
                    </div>
                    <small class="text-muted ms-2" id="serious_adverse_count" style="display: none;">(0)</small>
                    <div class="collapse mt-2 max-auto" id="pdf_serious_adverse" style="max-width: 800px;">
                        <div class="card card-body">
                            <div class="d-flex justify-content-center gap-2 mt-2">
                                <button class="btn btn-secondary btn-sm zoom-in" data-pdf="serious_adverse">Zoom
                                    In</button>
                                <button class="btn btn-secondary btn-sm zoom-out" data-pdf="serious_adverse">Zoom
                                    Out</button>
                            </div>
                            <canvas id="pdf_canvas_serious_adverse"
                                style="border: 1px solid #ccc; width: 100%;"></canvas>
                        </div>
                    </div>
                </li>

                <!-- 4. Mortality Event Prediction -->
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Mortality Event Prediction
                    <div>
                        <a href="https://zenodo.org/records/15455785/files/mortality-event-prediction.zip?download=1"
                            class="btn btn-dark btn-lg download-btn" data-key="mortality_prediction">
                            Download
                        </a>
                        <button class="btn btn-dark btn-lg" type="button" data-bs-toggle="collapse"
                            data-bs-target="#pdf_mortality_prediction" aria-expanded="false"
                            aria-controls="pdf_mortality_prediction">
                            Feature Set
                        </button>
                    </div>
                    <small class="text-muted ms-2" id="mortality_prediction_count" style="display: none;">(0)</small>
                    <div class="collapse mt-2 max-auto" id="pdf_mortality_prediction" style="max-width: 800px;">
                        <div class="card card-body">
                            <div class="d-flex justify-content-center gap-2 mt-2">
                                <button class="btn btn-secondary btn-sm zoom-in" data-pdf="mortality_prediction">Zoom
                                    In</button>
                                <button class="btn btn-secondary btn-sm zoom-out" data-pdf="mortality_prediction">Zoom
                                    Out</button>
                            </div>
                            <canvas id="pdf_canvas_mortality_prediction"
                                style="border: 1px solid #ccc; width: 100%;"></canvas>
                        </div>
                    </div>
                </li>

                <!-- 5. Trial Approval Forecasting -->
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Trial Approval Forecasting
                    <div>
                        <a href="https://zenodo.org/records/15455785/files/trial-approval-forecasting.zip?download=1"
                            class="btn btn-dark btn-lg download-btn" data-key="trial_approval">
                            Download
                        </a>
                        <button class="btn btn-dark btn-lg" type="button" data-bs-toggle="collapse"
                            data-bs-target="#pdf_trial_approval" aria-expanded="false"
                            aria-controls="pdf_trial_approval">
                            Feature Set
                        </button>
                    </div>
                    <small class="text-muted ms-2" id="trial_approval_count" style="display: none;">(0)</small>
                    <div class="collapse mt-2 max-auto" id="pdf_trial_approval" style="max-width: 800px;">
                        <div class="card card-body">
                            <div class="d-flex justify-content-center gap-2 mt-2">
                                <button class="btn btn-secondary btn-sm zoom-in" data-pdf="trial_approval">Zoom
                                    In</button>
                                <button class="btn btn-secondary btn-sm zoom-out" data-pdf="trial_approval">Zoom
                                    Out</button>
                            </div>
                            <canvas id="pdf_canvas_trial_approval"
                                style="border: 1px solid #ccc; width: 100%;"></canvas>
                        </div>
                    </div>
                </li>

                <!-- 6. Trial Failure Reason Identification -->
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Trial Failure Reason Identification
                    <div>
                        <a href="https://zenodo.org/records/15455785/files/trial-failure-reason-identification.zip?download=1"
                            class="btn btn-dark btn-lg download-btn" data-key="trial_failure">
                            Download
                        </a>
                        <button class="btn btn-dark btn-lg" type="button" data-bs-toggle="collapse"
                            data-bs-target="#pdf_trial_failure" aria-expanded="false" aria-controls="pdf_trial_failure">
                            Feature Set
                        </button>
                    </div>
                    <small class="text-muted ms-2" id="trial_failure_count" style="display: none;">(0)</small>
                    <div class="collapse mt-2 max-auto" id="pdf_trial_failure" style="max-width: 800px;">
                        <div class="card card-body">
                            <canvas id="pdf_canvas_trial_failure" style="border: 1px solid #ccc; width: 100%;"></canvas>
                            <div class="d-flex justify-content-center gap-2 mt-2">
                                <button class="btn btn-secondary btn-sm zoom-in" data-pdf="trial_failure">Zoom
                                    In</button>
                                <button class="btn btn-secondary btn-sm zoom-out" data-pdf="trial_failure">Zoom
                                    Out</button>
                            </div>
                        </div>
                    </div>
                </li>

                <!-- 7. Eligibility Criteria Design -->
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Eligibility Criteria Design
                    <div>
                        <a href="https://zenodo.org/records/15455785/files/eligibility-criteria-design.zip?download=1"
                            class="btn btn-dark btn-lg download-btn" data-key="eligibility_criteria">
                            Download
                        </a>
                        <button class="btn btn-dark btn-lg" type="button" data-bs-toggle="collapse"
                            data-bs-target="#pdf_eligibility_criteria" aria-expanded="false"
                            aria-controls="pdf_eligibility_criteria">
                            Feature Set
                        </button>
                    </div>
                    <small class="text-muted ms-2" id="eligibility_criteria_count" style="display: none;">(0)</small>
                    <div class="collapse mt-2 mx-auto" id="pdf_eligibility_criteria" style="max-width: 800px;">
                        <div class="card card-body">
                            <div class="d-flex justify-content-center gap-2 mt-2">
                                <button class="btn btn-secondary btn-sm zoom-in" data-pdf="eligibility_criteria">Zoom
                                    In</button>
                                <button class="btn btn-secondary btn-sm zoom-out" data-pdf="eligibility_criteria">Zoom
                                    Out</button>
                            </div>
                            <canvas id="pdf_canvas_eligibility_criteria"
                                style="border: 1px solid #ccc; width: 100%;"></canvas>
                        </div>
                    </div>
                </li>

                <!-- 8. Drug Dose Finding -->
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Drug Dose Finding
                    <div>
                        <a href="https://zenodo.org/records/15455785/files/drug-dose-prediction.zip?download=1"
                            class="btn btn-dark btn-lg download-btn" data-key="drug_dose_finding">
                            Download
                        </a>
                        <button class="btn btn-dark btn-lg" type="button" data-bs-toggle="collapse"
                            data-bs-target="#pdf_drug_dose_finding" aria-expanded="false"
                            aria-controls="pdf_drug_dose_finding">
                            Feature Set
                        </button>
                    </div>
                    <small class="text-muted ms-2" id="drug_dose_finding_count" style="display: none;">(0)</small>
                    <div class="collapse mt-2 mx-auto" id="pdf_drug_dose_finding" style="max-width: 800px;">
                        <div class="card card-body">
                            <div class="d-flex justify-content-center gap-2 mt-2">
                                <button class="btn btn-secondary btn-sm zoom-in" data-pdf="drug_dose_finding">Zoom
                                    In</button>
                                <button class="btn btn-secondary btn-sm zoom-out" data-pdf="drug_dose_finding">Zoom
                                    Out</button>
                            </div>
                            <canvas id="pdf_canvas_drug_dose_finding"
                                style="border: 1px solid #ccc; width: 100%;"></canvas>

                        </div>
                    </div>
                </li>

            </ul>
        </div>
    </section>

    <section class="download-code py-5">
        <div class="container">
            <h2 class="text-center mb-4">Download SubTask Datasets by Python/R code</h2>
            <div class="row">
                <div class="col-md-6 mb-4">
                    <h3 class="text-center">Python</h3>
                    <pre class="bg-light p-3"><code class="language-python">
import trialbench

# Download all datasets at once (optional)
save_path = 'data/'
trialbench.function.download_all_data(save_path)
                        
# Load dataset
task = 'dose'
phase = 'All'
                        
# Load dataloader.Dataloader 
train_loader, valid_loader, test_loader, num_classes, tabular_input_dim = trialbench.function.load_data(task, phase, data_format='dl')
# or Load pd.Dataframe
train_df, valid_df, test_df, num_classes, tabular_input_dim = trialbench.function.load_data(task, phase, data_format='df')
                </code></pre>
                </div>
                <div class="col-md-6 mb-4">
                    <h3 class="text-center">R</h3>
                    <pre class="bg-light p-3"><code class="language-r">
# Source the <function.R> first
source("your_path_to/r.trialbench/R/function.R", encoding = "UTF-8")
                            
# Download datasets (optional)
save_path <- "data/"
download_all_data(save_path)
# Load dataset
task <- "dose"
phase <- "All"
                            
# Retrieve DataFrames
data_list <- load_data(task, phase)
train_df <- data_list$train_df
valid_df <- data_list$valid_df
test_df <- data_list$test_df
                </code></pre>
                </div>
            </div>
        </div>
    </section>
    <!-- Results Section -->

    <div class="container">
        <!-- Table 1 -->
        <div class="results-table">
            <h3 class="text-center">Comparison of different phases from several angles</h3>
            <table style="border-collapse: collapse; border: medium; border-spacing: 0px;">
                <tr>
                    <td
                        style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                    </td>
                    <td
                        style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                    </td>
                    <td
                        style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                    </td>
                    <td
                        style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                    </td>
                </tr>
                <tr>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black; text-align: center; padding-right: 3pt; padding-left: 3pt;">
                    </td>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                        Phase I
                    </td>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                        Phase II
                    </td>
                    <td
                        style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                        Phase III
                    </td>
                </tr>
                <tr>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        Spent time
                    </td>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; padding-right: 3pt; padding-left: 3pt;">
                        1-2 years
                    </td>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; padding-right: 3pt; padding-left: 3pt;">
                        1-2 years
                    </td>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                        2-3 years
                    </td>
                </tr>
                <tr>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        Spent Money ($)
                    </td>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; padding-right: 3pt; padding-left: 3pt;">
                        225 M
                    </td>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; padding-right: 3pt; padding-left: 3pt;">
                        225 M
                    </td>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                        250 M
                    </td>
                </tr>
                <tr>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        Result
                    </td>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; padding-right: 3pt; padding-left: 3pt;">
                        5-10 candidates
                    </td>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; padding-right: 3pt; padding-left: 3pt;">
                        2-5 candidates
                    </td>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                        1-2 candidates
                    </td>
                </tr>
                <tr>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        Major objective
                    </td>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; padding-right: 3pt; padding-left: 3pt;">
                        safety
                    </td>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; padding-right: 3pt; padding-left: 3pt;">
                        safety and dosing
                    </td>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                        safety and efficacy
                    </td>
                </tr>
                <tr>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        # of patients
                    </td>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; padding-right: 3pt; padding-left: 3pt;">
                        20-80
                    </td>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; padding-right: 3pt; padding-left: 3pt;">
                        100-300
                    </td>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                        300-3000
                    </td>
                </tr>
                <tr>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; text-align: center; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                        Recruited patient
                    </td>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                        healthy
                    </td>
                    <td
                        style="border-right-width: 1px; border-right-style: solid; border-right-color: black; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                        with diseases
                    </td>
                    <td
                        style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                        with diseases
                    </td>
                </tr>
            </table>
        </div>

        <!-- Table 2 -->
        <div class="results-table">
            <h3 class="text-center"> Statistics of all the curated AI-solvable clinical trial datasets</h3>
            <table style="border-collapse: collapse; border: medium; border-spacing: 0px;">
                <!-- <caption>
                    Statistics of all the curated AI-solvable clinical trial datasets.
                </caption> -->
                <tr>
                <tr>
                    <td
                        style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                    </td>
                    <td
                        style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                    </td>
                    <td
                        style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                    </td>
                    <td
                        style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                    </td>
                    <td
                        style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                    </td>
                    <td
                        style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                    </td>
                    <td
                        style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                    </td>
                </tr>
                <td
                    style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black; text-align: center; padding-right: 3pt; padding-left: 3pt;">
                    Tasks
                </td>
                <td
                    style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black; text-align: center; padding-right: 3pt; padding-left: 3pt;">
                    # trials (I/II/III/IV)
                </td>
                <td
                    style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black; text-align: center; padding-right: 3pt; padding-left: 3pt;">
                    # drugs
                </td>
                <td
                    style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black; text-align: center; padding-right: 3pt; padding-left: 3pt;">
                    # med device
                </td>
                <td
                    style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black; text-align: center; padding-right: 3pt; padding-left: 3pt;">
                    # other inter
                </td>
                <td
                    style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black; text-align: center; padding-right: 3pt; padding-left: 3pt;">
                    # diseases
                </td>
                <td
                    style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black; text-align: center; padding-right: 3pt; padding-left: 3pt;">
                    Intervention study (%)
                </td>
                <td
                    style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black; text-align: center; padding-right: 3pt; padding-left: 3pt;">
                </td>
                </tr>
                <tr>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                        trial duration forecasting
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        143.8K (13.5K/13.4K/9.2K/7.1K)
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        40.8K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        21.1K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        83.6K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        44.6K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        77.3%
                    </td>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                    </td>
                </tr>
                <tr>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                        patient dropout event forecasting
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        62.1K (4.2K/15.8K/11.5K/6.9K)
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        29.7K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        10.9K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        20.7K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        21.9K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        94.5%
                    </td>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                    </td>
                </tr>
                <tr>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                        serious adverse event forecasting
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        31.3K (2.0K/8.1K/4.8K/2.9K)
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        15.9K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        6.6K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        12.4K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        15.9K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        96.0%
                    </td>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                    </td>
                </tr>
                <tr>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                        mortality event prediction
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        31.3K (2.0K/8.1K/4.8K/2.9K)
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        15.9K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        6.6K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        12.4K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        15.9K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        96.0%
                    </td>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                    </td>
                </tr>
                <tr>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                        trial approval forecasting
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        43.2K (4.5K/12.5K/9.2K/4.5K)
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        24.1K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        3.3K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        12.6K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        19.5K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        93.0%
                    </td>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                    </td>
                </tr>
                <tr>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                        trial failure reason identification
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        41.4K (4.3K/8.8K/4.2K/3.5K)
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        17.7K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        6.6K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        16.9K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        21.9K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        86.8%
                    </td>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                    </td>
                </tr>
                <tr>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                        eligibility criteria design
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        136.4K (19.4K/14.2K/10.8K/10.6K)
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        48.5K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        16.2K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        75.0K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        36.6K
                    </td>
                    <td style="text-align: center; padding-right: 3pt; padding-left: 3pt;">
                        84.9%
                    </td>
                    <td style="padding-right: 3pt; padding-left: 3pt;">
                    </td>
                </tr>
                <tr>
                    <td
                        style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                        drug dose finding
                    </td>
                    <td
                        style="text-align: center; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                        12.8K (0/12.8K/0/0)
                    </td>
                    <td
                        style="text-align: center; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                        11.0K
                    </td>
                    <td
                        style="text-align: center; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                        0.1K
                    </td>
                    <td
                        style="text-align: center; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                        1.2K
                    </td>
                    <td
                        style="text-align: center; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                        7.3K
                    </td>
                    <td
                        style="text-align: center; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                        100%
                    </td>
                    <td
                        style="border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: black; padding-right: 3pt; padding-left: 3pt;">
                    </td>
                </tr>
            </table>
        </div>


        <!-- Analysis Chart -->
        <div class="chart-container">
            <!-- <h3 class="mb-4">Result Analysis</h3> -->
            <img src="docs/combine3fig.png" alt="Result Analysis" class="img-fluid">
            <p class="mb-4">
                (a) A histogram showing the distribution of start dates for the selected trials reveals a steady
                increase in the number of initiated trials over time, reflecting the growing demand for new treatments.
                <br>
                (b) A statistical breakdown of the clinical trials by phase indicates that the majority of trials are in
                Phase II. <br>
                (c) The frequency of events varies across different phases, as exemplified by the dropout rates among
                participants. <br>
            </p>
        </div>
    </div>

    <script>
        // 定义每个 sub task 对应的 PDF 文件 URL
        const pdfUrls = {
            trial_duration: 'docs/trial-duration-forecasting.pdf',
            patient_dropout: 'docs/patient-dropout-event-forecasting.pdf',
            serious_adverse: 'docs/serious-adverse-event-forecasting.pdf',
            eligibility_criteria: 'docs/eligibility-criteria-design.pdf',
            trial_failure: 'docs/trial-failure-reason-identification.pdf',
            mortality_prediction: 'docs/mortality-event-prediction.pdf',
            drug_dose_finding: 'docs/trial-approval-forecasting.pdf',
            trial_approval: 'docs/trial-approval-forecasting.pdf',
            drug_dose_finding: 'docs/drug-dose-prediction.pdf',
            // 其他任务...
        };
        // PDF.js 全局设置
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js';

        // 存储各个 sub task 的 PDF 文档和缩放比例
        const pdfDocuments = {};

        // 加载并渲染 PDF 的通用函数
        function loadAndRenderPDF(pdfUrl, canvasId, scale) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            pdfjsLib.getDocument(pdfUrl).promise.then(pdfDoc => {
                pdfDocuments[canvasId] = { pdfDoc: pdfDoc, scale: scale || 1 };
                renderPage(pdfDoc, 1, scale || 1, canvas, ctx);
            }).catch(err => console.error('Error loading PDF:', err));
        }

        // 渲染 PDF 页面
        function renderPage(pdfDoc, pageNum, scale, canvas, ctx) {
            pdfDoc.getPage(pageNum).then(page => {
                const viewport = page.getViewport({ scale: scale });
                canvas.height = viewport.height;
                canvas.width = viewport.width;
                const renderContext = {
                    canvasContext: ctx,
                    viewport: viewport
                };
                page.render(renderContext);
            });
        }

        // 缩放 PDF：更新指定 canvas 的缩放比例并重新渲染
        function updatePDFZoom(canvasId, delta) {
            if (!pdfDocuments[canvasId]) return;
            pdfDocuments[canvasId].scale = Math.max(0.1, pdfDocuments[canvasId].scale + delta);
            const { pdfDoc, scale } = pdfDocuments[canvasId];
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            renderPage(pdfDoc, 1, scale, canvas, ctx);
        }

        // 为所有放大和缩小按钮绑定事件
        document.querySelectorAll('.zoom-in').forEach(btn => {
            btn.addEventListener('click', () => {
                const pdfKey = btn.getAttribute('data-pdf'); // 例如 "trial_duration"
                const canvasId = `pdf_canvas_${pdfKey}`;
                updatePDFZoom(canvasId, 0.1);
            });
        });

        document.querySelectorAll('.zoom-out').forEach(btn => {
            btn.addEventListener('click', () => {
                const pdfKey = btn.getAttribute('data-pdf');
                const canvasId = `pdf_canvas_${pdfKey}`;
                updatePDFZoom(canvasId, -0.1);
            });
        });

        // 当某个折叠区域展开时，加载对应的 PDF
        // 这里以 Trial Duration 为例；为其他任务重复类似逻辑
        const collapseTrialDuration = document.getElementById('pdf_trial_duration');
        collapseTrialDuration.addEventListener('shown.bs.collapse', () => {
            if (!pdfDocuments['pdf_canvas_trial_duration']) {
                loadAndRenderPDF(pdfUrls['trial_duration'], 'pdf_canvas_trial_duration', 1);
            }
        });

        // 对于其他 sub tasks，你可以为各自的 collapse 容器添加类似事件监听：
        const collapsePatientDropout = document.getElementById('pdf_patient_dropout');
        collapsePatientDropout.addEventListener('shown.bs.collapse', () => {
            if (!pdfDocuments['pdf_canvas_patient_dropout']) {
                loadAndRenderPDF(pdfUrls['patient_dropout'], 'pdf_canvas_patient_dropout', 1);
            }
        });

        const collapseSeriousAdverse = document.getElementById('pdf_serious_adverse');
        collapseSeriousAdverse.addEventListener('shown.bs.collapse', () => {
            if (!pdfDocuments['pdf_canvas_serious_adverse']) {
                loadAndRenderPDF(pdfUrls['serious_adverse'], 'pdf_canvas_serious_adverse', 1);
            }
        });

        const collapseEligibilityCriteria = document.getElementById('pdf_eligibility_criteria');
        collapseEligibilityCriteria.addEventListener('shown.bs.collapse', () => {
            if (!pdfDocuments['pdf_canvas_eligibility_criteria']) {
                loadAndRenderPDF(pdfUrls['eligibility_criteria'], 'pdf_canvas_eligibility_criteria', 1);
            }
        });

        const collapseFailureReason = document.getElementById('pdf_trial_failure');
        collapseFailureReason.addEventListener('shown.bs.collapse', () => {
            if (!pdfDocuments['pdf_canvas_trial_failure']) {
                loadAndRenderPDF(pdfUrls['trial_failure'], 'pdf_canvas_trial_failure', 1);
            }
        });

        const collapseMortalityPrediction = document.getElementById('pdf_mortality_prediction');
        collapseMortalityPrediction.addEventListener('shown.bs.collapse', () => {
            if (!pdfDocuments['pdf_canvas_mortality_prediction']) {
                loadAndRenderPDF(pdfUrls['mortality_prediction'], 'pdf_canvas_mortality_prediction', 1);
            }
        });

        const collapseTrialApproval = document.getElementById('pdf_trial_approval');
        collapseTrialApproval.addEventListener('shown.bs.collapse', () => {
            if (!pdfDocuments['pdf_canvas_trial_approval']) {
                loadAndRenderPDF(pdfUrls['trial_approval'], 'pdf_canvas_trial_approval', 1);
            }
        });

        const collapseDrugDoseFinding = document.getElementById('pdf_drug_dose_finding');
        collapseDrugDoseFinding.addEventListener('shown.bs.collapse', () => {
            if (!pdfDocuments['pdf_canvas_drug_dose_finding']) {
                loadAndRenderPDF(pdfUrls['drug_dose_finding'], 'pdf_canvas_drug_dose_finding', 1);
            }
        });

    </script>


    <meta charset="UTF-8">
    <title>World Map</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.highcharts.com/maps/highmaps.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <script src="https://code.highcharts.com/maps/modules/data.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.7.5/proj4.js"></script>
    <script src="world.js"></script>


    <!-- World Map Section -->
    <div id="mapContainer" style="height: 600px; min-width: 800px"></div>

    <!-- 前端脚本 -->
    <script>
        // 替换为你的 Cloudflare Worker URL
        const API_URL = "https://countryclicks.huuyjun.workers.dev";

        // 获取当前日期并格式化为 YYYY-MM-DD 格式
        const today = new Date();
        const formattedDate = today.getFullYear() + '-' +
            String(today.getMonth() + 1).padStart(2, '0') + '-' +
            String(today.getDate()).padStart(2, '0');

        // 更新全局下载计数：调用 /hit?type=download&action=get
        function updateGlobalDownloadCount() {
            fetch(`${API_URL}/hit?type=download&action=get`)
                .then(res => res.json())
                .then(data => {
                    document.getElementById('all_count').textContent =
                        `Until ${formattedDate}, data has been downloaded ${data.total} times.`;
                })
                .catch(err => console.error('Error fetching global download count:', err));
        }
        updateGlobalDownloadCount();

        // 记录网页访问次数（调用 visit 接口）
        fetch(`${API_URL}/hit?type=visit&action=hit`)
            .then(res => res.json())
            .then(data => {
                console.log("Page visit recorded for", data.country, ":", data.visits);
            })
            .catch(err => console.error('Error recording page visit:', err));

        document.querySelectorAll('.download-btn').forEach(btn => {
            const key = btn.getAttribute('data-key');  // 例如 "trial_duration"
            const countSpan = document.getElementById(key + '_count');

            // 点击时：先调用下载统计接口（action=hit），更新计数，再触发下载
            btn.addEventListener('click', e => {
                e.preventDefault();
                fetch(`${API_URL}/hit?type=download&action=hit`)
                    .then(res => res.json())
                    .then(data => {
                        document.getElementById('all_count').textContent = `Until ${formattedDate}, data has been downloaded ${data.total} times.`;//`Downloaded ${data.individual} times`;

                        // 触发下载：创建临时链接点击
                        const tempLink = document.createElement('a');
                        tempLink.href = btn.href;
                        tempLink.click();

                    })
                    .catch(err => console.error(err));
            });
        });

        // 高charts地图变量
        let chart;

        // 初始化地图
        function initMap(initialData) {
            chart = Highcharts.mapChart('mapContainer', {
                chart: { map: 'custom/world' },
                title: { text: 'Global Page Visit Distribution' },
                colorAxis: {
                    min: 0,
                    stops: [
                        [0, '#EFEFFF'],
                        [0.5, '#4444FF'],
                        [1, '#000022']
                    ]
                },
                series: [{
                    data: initialData,
                    name: 'Visits',
                    states: { hover: { color: '#a4edba' } },
                    dataLabels: { enabled: true, format: '{point.name}' },
                    tooltip: { valueSuffix: '' }
                }]
            });
        }

        // 获取访问统计数据并更新地图
        function fetchStatsAndUpdateMap() {
            fetch(`${API_URL}/stats?type=visit`)
                .then(response => response.json())
                .then(data => {
                    // 将数据转换为 Highcharts 格式：[ [ 'us', visits ], [ 'in', visits ], ... ]
                    const chartData = Object.entries(data).map(([countryCode, visits]) => {
                        return [countryCode.toLowerCase(), visits];
                    });
                    if (chart) {
                        chart.series[0].setData(chartData);
                    } else {
                        initMap(chartData);
                    }
                })
                .catch(err => console.error('Error fetching global stats:', err));
        }

        // 页面加载时获取一次统计数据
        fetchStatsAndUpdateMap();
        // 若希望实时更新，可设置定时器每隔一段时间刷新地图数据
        // setInterval(fetchStatsAndUpdateMap, 30000); // 每 30 秒刷新一次
    </script>

</body>

</html>